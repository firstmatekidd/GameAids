<!DOCTYPE HTML>
<html>
<head>
<style>

/*
TODO LIST:;
	Limit Rate of Fire options based on data input
	Add more/all talents
	Create a talent selector so you can add just the talents you have
*/

body
{
	width:960px;
	margin:auto;
}
#sidead
{
	width:728px;
	height:90px;
	top:0px;
	left:0px;
	background-color:#999999;
	margin-left:116px;
	margin-bottom:10px;
}
#content
{
	width:960px;
	margin:auto;
	background-color:#cccccc;
	margin-bottom:10px;
}
div
{
	width:100%;
	float:left; 
}
span
{
	float:left;
}
.column
{
	margin:0px;
	padding-left:5px;
	padding-right:5px;
	border:0px;
	width:470px;
}
#header
{
	border:0px;
	text-align:center;
	font-size:48px;
	background-color:#ffffff;
	margin-bottom:5px;
}
#footer
{
	border:0px;
	width:100%;
	text-align:center;
	margin-bottom:10px;
}
#calculator
{
	width:950px;
	min-height:150px;
	margin-left:5px;
	margin-right:5px;
	margin-top:5px;
	background-color:#ffffff;
}
#weapon, #shotmodifiers, #targetmodifiers, #talents
{
	min-height:360px;
	background-color:#ffffff;
}
#comrade, #about
{
	min-height:147px;
	background-color:#ffffff;
}
.sectionheader
{
	width:100%;
	background-color:#eeeeee;
	margin:0px;
	margin-bottom:5px;
	padding:5px;
}
.boxheader
{
	width:100%;
	background-color:#eeeeee;
	position:absolute;
	margin:-2px;
	text-align:center;
}
.boxfooter
{
	width:100%;
	background-color:#eeeeee;
	position:absolute;
	bottom:0px;
	margin:-2px;
	text-align:center;
}
.rounded
{
	border-radius:12px;
	overflow:hidden;
	margin-bottom:10px;
}
.cornered
{
	border:1px 
	solid #aaaaaa;
}
#BallisticSkillContainer
{
	position:relative;
	width:106px;
	height:100px;
	margin-left:5px;
	padding:2px;
}

#BallisticSkill
{
	float:left;
	width:100px;
	height:100px;
	font-size:30px;
	text-align:center;
	vertical-align:center;
	overflow-y:hidden;
	border:0px;
}
#FinalModifierDescription
{
	position:relative;
	float:left;
	width:170px;
	height:100px;
	padding:2px;
	overflow-y:auto;
}
#FinalResultDescription
{
	position:relative;
	float:left;
	width:290px;
	height:100px;
	padding:2px;
	margin-left:5px;
}
#resultDescription
{
	width:100%;
	height:68px;
	margin:0px;
	padding-top:16px;
	padding-bottom:16px;
	overflow-y:auto;
}
#DiceRoll
{
	position:relative;
	float:left;
	width:150px;
	height:100px;
	padding:2px;
}
#diceValue
{
	font-size:30px;
	text-align:center;
	vertical-align:center;
}
.diceSlider
{
	position:absolute;
	bottom:0px;
	width:95%;
}
.BigLetter
{
	margin:0px;
	float:left;
	width:50px;
	height:100px;
	text-align:center;
	font-size:20px;
	line-height:100px;
}
#FinalBallisticSkill
{
	margin:0px;
	float:left;
	width:100px;
	height:100px;
	text-align:center;
	font-size:50px;
	line-height:100px;
}
.modifier, .radiomodifier, .checkboxmodifier, .slidermodifier
{
	margin-bottom:5px;
	margin-left:1%;
	margin-right:1%;
	width:98%;
}
textarea
{
	padding:0px;
}
label
{
	width:120px;
	display:inline-block;
}
input[type=range]
{
	float:left;
}
input[type=checkbox]
{
	float:left;
}

#valueDescription
{
	float:left;
	display:inline-block;
	margin:0px;
}
#weaponRange
{
	width:50px;
	margin-right:5px;
}
.rangeslider
{
	width:220px;
}
.fullwidth
{
	float:left;
	display:inline-block;
	width:100%;
	margin-bottom:5px;
}
.halfwidth
{
	float:left;
	display:inline-block;
	width:50%;
	margin-bottom:5px;
}
.hitDescription
{
	font-size:16px;
	text-align:left;
}
.missDescription
{
	font-size:40px;
	text-align:center;
	vertical-align:center;
}
#damageDice, #damageAdd, #damagePen, #singleShotAmount, #semiAutoAmount, #fullAutoAmount, #fatigueLevel
{
	width:28px;
}
#fatigueLevel
{
	float:left;
	margin-right:5px;
}
#popup
{
	position: fixed;
	width: 100%;
	height: 100%;
	left: 0;
	top: 0;
	right:0;
	bottom:0;
	background-color: rgba(0,0,0,0.4);
	z-index:1;
	visibility:hidden;
}
#popupClose
{
	position:absolute;
	top:5px;
	right:5px;
	width:30px;
}
#popupContents
{
	position:fixed;
	width:80%;
	height:700px;
	left: 20%;
	top:50px;
	margin-left:-10%;
	background-color:#ffffff;
	padding:2px;
}
#popupHeader
{
	height:36px;
	font-size:26px;
}
#popupBody
{
	margin-top:36px;
	width:100%;
}
.hoverable
{
	cursor: pointer; 
	cursor: hand;
	text-decoration: underline;
	color:#44cc33;
}
</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-12739434-2', 'auto');
  ga('send', 'pageview');

var finalDescription = "";
var finalDamageDescription = "";

var modifierDescriptions = {
	attackType:{
		single: {value:10,description:"Single Shot (+10)"},
		semi: {value:0,description:"Semi Auto (+0)"},
		full: {value:-10,description:"Full Auto (-10)"}
	},
	aimModifier:{
		none: {value:0,description:""},
		half: {value:10,description:"Half Aim (+10)"},
		full: {value:20,description:"Full Aim (+20)"}
	},
	targetSizeModifier:{
		"-30":"Miniscule (-30)",
		"-20":"Puny (-20)",
		"-10":"Scrawny (-10)",
		0:"Average (+0)",
		10:"Hulking (+10)",
		20:"Enormous (+20)",
		30:"Massive (+30)",
		40:"Immense (+40)",
		50:"Monumental (+50)",
		60:"Titanic (+60)",
	},
	targetStunnedModifier:{
		value:20,
		description:"Target Stunned (+20)"
	},
	targetProneModifier:{
		value:-20,
		description:"Target Prone (-20)"
	},
	targetRanModifier:{
		value:-20,
		description:"Target Ran (-20)"
	},
	hatredTalent:{
		value:10,
		description:"Hatred (+10)"
	},
	comradeOrderModifier:{
		none:{value:0,description:""},
		normal:{value:5,description:"Comrade Order (+5)"},
		veteran:{value:10,description:"Comrade Order (+10)"}
	},
	guardedActionModifier:{
		value:-10,
		description:"Guarded Action (-10)"
	},
	suppressingFireModifier:{
		value:-20,
		description:"Suppressing Fire (-20)"
	},
	miscellaneousModifier:{
		description:"Miscellaneous"
	},
	targetUnaware:{
		value:30,
		description:"Target Unaware (+30)"
	},
	shootingIntoMeleeModifier:{
		value:-20,
		description:"Shot Into Melee (-20)"
	},
	darknessModifier:{
		value:-30,
		description:"Dark (-30)"
	},
	fogModifier:{
		value:-20,
		description:"Fog/Mist/Smoke (-20)"
	},
	weaponCustomGripModifier:{
		value:5,
		description:"Custom Grip (+5)"
	},
	calledShotModifier:{
		value:-20,
		description:"Called Shot (-20)"
	},
	weaponUntrainedModifier:{
		value:-20,
		description:"Weapon Untrained (-20)"
	},
	weaponHeavyBracedModifier:{
		value:-30,
		description:"Heavy Unbraced (-30)"
	},
	weaponScatter:{
		value:0,
		description:"Scatter weapon"
	},
	weaponOverheats:{
		value:0,
		description:"Overheats"
	},
	weaponMaximal:{
		value:0,
		description:"Maximal"
	},
	targetRangeModifier:{
		pointBlank:
		{
			value:30,
			description:"Point Blank (+30)"
		},
		shortRange:
		{
			value:10,
			description:"Short Range (+10)"
		},
		standardRange:
		{
			value:0,
			description:"Standard Range (0)"
		},
		longRange:
		{
			value:-20,
			description:"Long Range (-20)"
		},
		extremeRange:
		{
			value:-30,
			description:"Extreme Range (+30)"
		}
	}
};

var multipleHitTable = {
	head:[
		"head",
		"arm",
		"body",
		"arm",
		"body"
	],
	arm:[
		"arm",
		"body",
		"head",
		"body",
		"arm"
	],
	body:[
		"body",
		"arm",
		"head",
		"arm",
		"body"
	],
	leg:[
		"leg",
		"body",
		"arm",
		"head",
		"body"
	]
}
function initialize()
{
	loadOptions();

	weaponRangeChange();
	targetRangeChanged();
	diceRollChanged();
	recalculate();
	hidePopup();
}

function recalculate() 
{
	var finalModifier = 0;
	finalDescription = "";

	finalModifier += addModifiersFromCategory('shotmodifiers');
	finalModifier += addModifiersFromCategory('targetmodifiers');
	finalModifier += addModifiersFromCategory('comrade');
	finalModifier += addModifiersFromCategory('weapon');
	finalModifier += addModifiersForRange();
	finalModifier += addConditionalModifiers();

  var BS = parseInt(document.getElementById("BallisticSkill").value)

	var fatigueLevel = parseInt(document.getElementById("fatigueLevel").value);
	if (fatigueLevel > (BS/10))
	{
		finalDescription = "Fatigued (1/2 BS)<br>" + finalDescription;
		BS = Math.ceil(BS/2);
	}

  document.getElementById("FinalModifierDescription").innerHTML = finalDescription;

  finalModifier += BS;
	if (finalModifier < 0)
		finalModifier = 0;

  document.getElementById("FinalBallisticSkill").innerHTML = finalModifier;

  calculateResult();
}

function addModifiersFromCategory(categoryID)
{
	var returnModifier = 0;
	var categoryElement = document.getElementById(categoryID)

	var modifiers = categoryElement.getElementsByClassName('radiomodifier')
	for (idx=0;idx < modifiers.length;idx++)
	{
		returnModifier += radioValue(modifiers[idx].id);
	}

	modifiers = categoryElement.getElementsByClassName('checkboxmodifier')
	for (idx=0;idx < modifiers.length;idx++)
	{
		returnModifier += checkboxValue(modifiers[idx].id);
	}

	modifiers = categoryElement.getElementsByClassName('slidermodifier')
	for (idx=0;idx < modifiers.length;idx++)
	{
		returnModifier += sliderValue(modifiers[idx].id);
	}

	return returnModifier;
}

function addConditionalModifiers()
{
	var conditionalModifier = 0;

	var hasLaserSight = document.getElementById("weaponLaserSight").children.check.checked;
	var isSingleShot = document.getElementById("attackType").children.single.checked;

	if (hasLaserSight && isSingleShot)
	{
		conditionalModifier += 10;
		finalDescription += "Laser Sight (+10)<br>"
	}

	return conditionalModifier;
}

function sliderValue(sliderID)
{
	var targetModifier = document.getElementById(sliderID);
	var modifier = targetModifier.children.slider.value;
	if (modifier != 0)
	{
		if (typeof modifierDescriptions[sliderID].description === "undefined")
			finalDescription += modifierDescriptions[sliderID][modifier] + "<br>";
		else
		{
			if (modifier > 0)
				finalDescription += modifierDescriptions[sliderID].description + " (+" + modifier + ")<br>";
			else
				finalDescription += modifierDescriptions[sliderID].description + " (" + modifier + ")<br>";
		}
	}
	return parseInt(modifier);
}
function sliderChanged(sliderID)
{
	var targetModifier = document.getElementById(sliderID);
	var modifier = targetModifier.children.slider.value;

  var description = modifierDescriptions[sliderID][modifier];
  if (description)
		targetModifier.children.valueDescription.innerHTML = description;
	else
	{
		if (modifier > 0)
			targetModifier.children.valueDescription.innerHTML = "+" + modifier;
		else
			targetModifier.children.valueDescription.innerHTML = modifier;
	}

	recalculate();
}

function checkboxValue(checkboxID)
{
	var targetModifier = document.getElementById(checkboxID);
	if (targetModifier.children.check.checked)
	{
		var modifier = modifierDescriptions[checkboxID].value;
		if (modifier != 0)
			finalDescription += modifierDescriptions[checkboxID].description + "<br>";
		return modifier;
	}

	return 0;
}

function radioValue(radioID)
{
	var radioModifier = document.getElementById(radioID);

	var radios = radioModifier.getElementsByTagName('input')
	for (i=0;i < radios.length;++i)
	{
		if (radios[i].checked)
		{
			var modifier = modifierDescriptions[radioID][radios[i].id].value;
			if (modifier != 0)
				finalDescription += modifierDescriptions[radioID][radios[i].id].description + "<br>";
			return modifier;
		}
	}

	return 0;
}

function diceRollChanged()
{
	var diceSlider = document.getElementById("DiceRoll").children.slider;
	var diceDisplay = document.getElementById("diceValue");

	diceDisplay.innerHTML = diceSlider.value;

  calculateResult();
}

function calculateResult()
{
	var resultDescription = document.getElementById("resultDescription");

	var diceDisplay = document.getElementById("diceValue");
	var diceRollValue = parseInt(diceDisplay.innerHTML);

	var finalBallisticSkillDisplay = document.getElementById("FinalBallisticSkill");
	var finalBallisticSkillValue = parseInt(finalBallisticSkillDisplay.innerHTML);

	var dieDegree = Math.floor(diceRollValue / 10);
	var checkDegree = Math.floor(finalBallisticSkillValue / 10);

	var isOverheat = document.getElementById("weaponOverheats").children.check.checked;
	if (isOverheat && diceRollValue >= 91)
	{
		resultDescription.innerHTML = "OVERHEAT!";
		resultDescription.className = "missDescription";

		document.getElementById("degreesOfSuccess").innerHTML = "Damage to Arm (Pen 0). AGI drops weapon for no damage. Cannot fire next round."
	}
	else if (diceRollValue <= finalBallisticSkillValue && diceRollValue < 95)
	{
		var degreesOfSuccess = (checkDegree - dieDegree) + 1;

		var hitDescription = "";

		if (document.getElementById("lasWeaponExpertiseTalent").children.check.checked)
		{
			var dodgePenalty = (degreesOfSuccess-1)*5;
			if (dodgePenalty > 30)
				dodgePenalty = 30;

			if (dodgePenalty > 0)
				hitDescription += "Target Dodge Penalty: -" + dodgePenalty + "<br>";
		}

		if (document.getElementById("lasgunBarrageTalent").children.check.checked)
		{
			//Adds one degree of success on full or semi-auto
			if (!document.getElementById("attackType").children.single.checked)
			{
				degreesOfSuccess += 1;
				finalDamageDescription += "Lasgun Barrage: +1 DoS<br>";
			}
		}
		document.getElementById("degreesOfSuccess").innerHTML = "" + degreesOfSuccess + " Degrees Of Success";
		hitDescription += "HIT 1:";


		var diceOnes = diceRollValue - (dieDegree*10);
		var hitLocation = (diceOnes*10) + dieDegree;
		var damageType = document.getElementById("weaponDamageType").value;

		if (document.getElementById("calledShotModifier").children.check.checked)
		{
			var calledRadios = document.getElementsByName("calledShotChoice");

			for (calledIdx = 0;calledIdx < calledRadios.length;++calledIdx)
			{
				if (calledRadios[calledIdx].checked)
				{
					hitLocation = calledRadios[calledIdx].id;
					hitDescription += " " + hitLocation;
				}
			}
		}
		else
		{
			if (hitLocation <= 10)
			{
				hitDescription += " Head";
				hitLocation = 'head';
			}
			else if (hitLocation <= 20)
			{
				hitDescription += " Right Arm";
				hitLocation = 'arm';
			}
			else if (hitLocation <= 30)
			{
				hitDescription += " Left Arm";
				hitLocation = 'arm';
			}
			else if (hitLocation <= 70)
			{
				hitDescription += " Body";
				hitLocation = 'body';
			}
			else if (hitLocation <= 85)
			{
				hitDescription += " Right Leg";
				hitLocation = 'leg';
			}
			else
			{
				hitDescription += " Left Leg" ;
				hitLocation = 'leg';
			}
		}

		hitDescription += " " + damageDescription(degreesOfSuccess) + " " + critLink(hitLocation, damageType);

		var isScatter = document.getElementById("weaponScatter").children.check.checked;
		var isPointBlank = parseInt(document.getElementById("targetRangeModifier").children.slider.value) <= 2;

	  if (document.getElementById("attackType").children.semi.checked)
	  {
	  	var extraHits = Math.ceil((degreesOfSuccess-1)/2);

	  	if (isScatter && isPointBlank)
	  		extraHits += Math.ceil((degreesOfSuccess)/2);

	  	var maxExtraHits = parseInt(document.getElementById("semiAutoAmount").value)-1;

	  	if (extraHits > maxExtraHits)
	  		extraHits = maxExtraHits;

	  	for (hitIdx = 0;hitIdx < extraHits;++hitIdx)
	  	{
	  		var tableIdx = hitIdx;
	  		if(tableIdx >= multipleHitTable[hitLocation].length)
	  			tableIdx = multipleHitTable[hitLocation].length-1;

	  		var nextHitLocation = multipleHitTable[hitLocation][tableIdx];
		  	hitDescription += "<br>HIT " + (hitIdx+2) + ": " + nextHitLocation + " " + damageDescription(degreesOfSuccess) + " " + critLink(nextHitLocation, damageType);
	  	}
	  }
	  else if (document.getElementById("attackType").children.full.checked)
	  {
	  	var extraHits = degreesOfSuccess;

	  	if (isScatter && isPointBlank)
	  		extraHits += Math.ceil((degreesOfSuccess)/2);
	  	
	  	var maxExtraHits = parseInt(document.getElementById("fullAutoAmount").value)-1;

	  	if (extraHits > maxExtraHits)
	  		extraHits = maxExtraHits;

	  	for (hitIdx = 0;hitIdx < extraHits;++hitIdx)
	  	{
	  		var tableIdx = hitIdx;
	  		if(tableIdx >= multipleHitTable[hitLocation].length)
	  			tableIdx = multipleHitTable[hitLocation].length-1;

	  		var nextHitLocation = multipleHitTable[hitLocation][tableIdx];
		  	hitDescription += "<br>HIT " + (hitIdx+2) + ": " + nextHitLocation + " " + damageDescription(degreesOfSuccess) + " " + critLink(nextHitLocation, damageType);
	  	}
	  }
		resultDescription.innerHTML = hitDescription;
		resultDescription.className = "hitDescription";
	}
	else
	{
		resultDescription.innerHTML = "MISS!";
		resultDescription.className = "missDescription";

		var degreesOfSuccess = (dieDegree - checkDegree) + 1;
		document.getElementById("degreesOfSuccess").innerHTML = "" + degreesOfSuccess + " Degrees Of Failure";
	}

	saveOptions();
}

function saveOptions()
{
	var saveBlock = {
		checkboxes:[],
		radios:[],
		sliders:[],
		numbers:[],
		texts:[],
		selects:[]
	};

	var inputs = document.getElementsByTagName("input");
	for (inputIdx = 0;inputIdx < inputs.length;++inputIdx)
	{
		var input = inputs[inputIdx];

		if (input.type == "checkbox" && input.checked)
		{
			saveBlock.checkboxes.push(input.parentElement.id);
		}
		else if (input.type == "number")
		{
			saveBlock.numbers.push([input.id, input.value]);
		}
		else if (input.type == "range")
		{
			saveBlock.sliders.push([input.parentElement.id, input.value]);
		}
		else if (input.type == "radio" && input.checked)
		{
			saveBlock.radios.push([input.parentElement.id, input.id]);
		}
	}

	inputs = document.getElementsByTagName("select");
	for (inputIdx = 0;inputIdx < inputs.length;++inputIdx)
	{
		var input = inputs[inputIdx];

		saveBlock.selects.push([input.id, input.value]);
	}

	inputs = document.getElementsByTagName("textarea");
	for (inputIdx = 0;inputIdx < inputs.length;++inputIdx)
	{
		var input = inputs[inputIdx];

		saveBlock.texts.push([input.id, input.value]);
	}

	localStorage.weapon1 = JSON.stringify(saveBlock);
}

function loadOptions()
{
	if (localStorage.weapon1)
	{
		var loadBlock = JSON.parse(localStorage.weapon1);

		for (loadIdx = 0;loadIdx < loadBlock.checkboxes.length;++loadIdx)
		{
			document.getElementById(loadBlock.checkboxes[loadIdx]).children.check.checked = true;
		}

		for (loadIdx = 0;loadIdx < loadBlock.radios.length;++loadIdx)
		{
			document.getElementById(loadBlock.radios[loadIdx][0]).querySelector("#" + loadBlock.radios[loadIdx][1]).checked = true;
		}

		for (loadIdx = 0;loadIdx < loadBlock.selects.length;++loadIdx)
		{
			document.getElementById(loadBlock.selects[loadIdx][0]).value = loadBlock.selects[loadIdx][1];
		}

		talentChanged();

		for (loadIdx = 0;loadIdx < loadBlock.numbers.length;++loadIdx)
		{
			document.getElementById(loadBlock.numbers[loadIdx][0]).value = loadBlock.numbers[loadIdx][1];
		}

		for (loadIdx = 0;loadIdx < loadBlock.texts.length;++loadIdx)
		{
			document.getElementById(loadBlock.texts[loadIdx][0]).value = loadBlock.texts[loadIdx][1];
		}

		weaponRangeChange();

		for (loadIdx = 0;loadIdx < loadBlock.sliders.length;++loadIdx)
		{
			var slider = document.getElementById(loadBlock.sliders[loadIdx][0]).children.slider;
			slider.value = loadBlock.sliders[loadIdx][1];
		}

		sliderChanged("targetSizeModifier");
		sliderChanged("miscellaneousModifier");
	}
}

function damageDescription(degreesOfSuccess)
{
	var damageDice = parseInt(document.getElementById("damageDice").value);
	var damageAdd = parseInt(document.getElementById("damageAdd").value);
	var penetration = parseInt(document.getElementById("damagePen").value);

	finalDamageDescription = "<br>" + degreesOfSuccess + " Degrees of Success";
	if (document.getElementById("lasgunBarrageTalent").children.check.checked)
	{
		//Adds one degree of success on full or semi-auto
		if (!document.getElementById("attackType").children.single.checked)
		{
			degreesOfSuccess += 1;
			finalDamageDescription += "<br>Lasgun Barrage: +1 DoS";
		}
	}

	if (document.getElementById("weaponMaximal").children.check.checked)
	{
		damageDice += 1;
		penetration += 2;
		//Add 2 to blast
	}
	finalDamageDescription += "<br>Base Damage: " + damageDice + "d10+" + damageAdd + " Pen " + penetration;

	var isAiming = !document.getElementById("aimModifier").children.none.checked;
	var usingComrade = !document.getElementById("comradeOrderModifier").children.none.checked;
	var targetIsUnaware = document.getElementById("targetUnaware").children.check.checked;
	var isAmbushing = targetIsUnaware && document.getElementById("ambushTalent").children.check.checked;

	if (document.getElementById("mightyShotTalent").children.check.checked)
	{
		var BallisticSkill = parseInt(document.getElementById("BallisticSkill").value)
		var BallisticSkillBonus = Math.floor(BallisticSkill/10);
		var bonus = Math.ceil(BallisticSkillBonus/2);
		damageAdd += bonus;

		if (bonus > 0)
			finalDamageDescription += "<br>Mighty Shot: +" + bonus;
	}

	if ((degreesOfSuccess > 0) && document.getElementById("eyeOfVengeanceTalent").children.check.checked)
	{
		damageAdd += degreesOfSuccess;
		penetration += degreesOfSuccess;

		finalDamageDescription += "<br>Eye Of Vengeance: +" + degreesOfSuccess + " Pen +" + degreesOfSuccess;
	}	


	if (document.getElementById("lasWeaponMasteryTalent").children.check.checked)
	{
		var bonus = Math.floor((degreesOfSuccess-1)/2);

		damageAdd += bonus;

		if (bonus > 0)
			finalDamageDescription += "<br>Las Weapon Mastery: +" + bonus;
	}	

	if (usingComrade && document.getElementById("lasgunVolleyTalent").children.check.checked)
	{
		damageAdd += 1;

		finalDamageDescription += "<br>Lasgun Volley: +1";
	}
	
	if (isAmbushing)
	{
		var bonus = Math.floor(degreesOfSuccess/2);

		damageAdd += bonus;

		if (bonus)
			finalDamageDescription += "<br>Ambush Talent and Unaware Target: + " + bonus;
	}

	var damageString = damageDice + "d10+" + damageAdd;

	if (isAiming && document.getElementById("weaponAccurate").children.check.checked)
	{
		var extraDice = Math.floor((degreesOfSuccess-1)/2);
		if (extraDice > 2)
			extraDice = 2;

		if (extraDice > 0)
		{
			damageString += "+" + extraDice + "d10"

			finalDamageDescription += "<br>Aiming and Weapon is Accurate: + " + extraDice + "d10 (cannot generate righteous fury)";
		}
	}	

	damageString += " Pen " + penetration;

	finalDamageDescription += "<br><br>Final Damage: " + damageString;

	return damageString;
}

function critLink(location, damageType)
{
	return "<sup class='hoverable' title='Click to show crit table for location and damage type' onClick='showCritTable(\"" + location + "\",\"" + damageType + "\")'> &#8594;</sup>";
}

function showCritTable(location, damageType)
{
	var critTables = {
		energy:{
			upper:"Energy",
			arm:{
				upper:"Arm",
				effects:[
					"The attack grazes the target's arm, causing it to spasm uncontrollably. All Tests involving that arm suffer a -30 penalty for 1d5 Rounds.",
					"The attack smashes into the arm, sending currents of energy crackling down to the fingers and up to the shoulder. The arm is useless for 1d5 Rounds and the target takes 1 level of Fatigue.",
					"kThe arm suffers superficial burns inflicting no small amount of pain on the target. The target may only take a Half Action in his next Round and he suffers 1d5 levels of Fatigue.",
					"The shock of the attack causes the character to temporarily lose control of his autonomous functions. He is Stunned for 1 Round and is knocked Prone. The arm is useless for 1d10 Rounds.",
					"The attack causes energy to course through the target's arm leaving him Stunned for 1 Round, and the arm is useless until the target receives medical treatment.",
					"The attack wreathes the arm in flame, scorching clothing and armour, and temporarily fusing together the target's fingers. The target suffers 1d5 Weapon Skill and Ballistic Skill Damage, suffers 1d5 levels of Fatigue, and must make a Challenging (+0) Toughness Test or lose the use of the hand permanently.",
					"With a terrible snapping sound, the heat of the attack boils the marrow in the target's arm, causing it to crack and even shatter. The target's arm is broken and, until it is repaired, the target counts as only having one arm. The target is Stuned for 1 Round and suffers 1d5 levels of Fatigue.",
					"Energy ripples across the target's arm, causign skin and muscle to slough disgunstingly from the target's limb, revealing a sticky red mess of sinew and bone. The target must take a Challenging (+0) Toughness Test or become Stunned for 1d5 Rounds. In addition, the target suffers 1d10 levels of Fatigue. The target now only has one arm.",
					"Fire consumes the target's arm, burning the flesh to a crisp right down to the bone. The target must make an immediate Challenging (+0) Toughness Test or die from shock. If he survives, however the target suffers 1d10 levels of Fatigue and is Stunned for 1 Round. The target now only has one arm.",
					"The attack reduces the arm to a cloud of ash and sends the target crumbling to the ground where he immediately dies from shock, clutchin his smoking stump."
				]
			},
			head:{
				upper:"Head",
				effects:[
					"A grazing blow to the head disorients the target, imposing a -10 penalty to all Tests (except Toughness) for 1 Round.",
					"The blast of energy dazzles the target, leaving him Blinded for 1 Round.",
					"The attack cooks off the target's ear, leaving him with a partially burned stump of cartilage and deafened until he receives first aid or waits for 1d5 hours.",
					"Th energy attack burns away all of the hairs of the taget's head as well as leaving him reeling from the injury. The attack deals 2 levels of Fatigue and the target is blined for 1d5 Rounds.",
					"A blast of energy envelops the target's head, burning his face and hair, crisping his skin, and causing him to scream like a stuck Groz. In addition to losing his hair, he is blinded for 1d10 Rounds, Stuned for 1 Round, and takes 1 permanent Fellowship Damage.",
					"The attack cooks the target's face, melting his features and damaging his eyes. The target is blinded for the next 1d10 hours and suffers 1d5 permanent Fellowship Damage and 1d5 permanent Perception Damage. The target also suffers 1d5 levels of Fatigue.",
					"In a gruesome display, the flesh is burned from the target's head, exposing charred bone and muscle underneath. The target is blinded permanently and suffers 1d10 levels of Fatigue. Also, roll 1d10. This is the targets new Fellowship, unless their Fellowship is already 10 or less, in which case don't bother rolling, as nobody really notices the difference.",
					"The target's head is destroyed in a conflagration of fiery death. He does not survive.",
					"Superheated by the attack, the target's brain explodes, tearing apart his skull and sending flaming chunks of meat flying at those nearby. The target is very dead!",
					"As above, except the target's entire body catches fire and runs off headless 2d10 metres in a random direction (use the Scatter Diagram on page 255). Anything flammable it passes, including characters, must make a Challenging (+0) Agility Test or catch fire (see Special Damage, page 266)."
				]
			},
			body:{
				upper:"Body",
				effects:[
					"A blow to the target's body steals the air from his lungs. The target can take only a Half Action for his next Turn.",
					"The blast punches the air from the target's body. The target must make a Challenging (+0) Toughness Test or be knocked Prone.",
					"The attack cooks the flesh on the chest and abdomen, inflicting 2 levels of Fatigue and 1d5 Toughness Damage.",
					"The energy ripples all over the character, scorching his body with horrid third-degree burns and inflicting 1d10 levels of Fatigue. The target may only take a Half Action on his next Round.",
					"The fury of the attack forces the target to the ground, helplessly covering his face and keening in agony. The target is knocked Prone and must make a Challenging (+0) Agility Test or catch fire (see Special Damage). The target must also make a Challenging (+0) Toughness Test or be Stunned for 1 Round.",
					"Struck by the full force of the attack, the target is sent reeling to the ground; smoke spiralling out from the wound. The target is knocked Prone, Stunned for 1d10 Rounds, and suffers 1d5 levels of Fatigue. In addition, he must make a Challenging (+0) Agility Test or catch fire (see Special Damage on page 266).",
					"The intense power of the energy attack cooks the target's organs, burning his lungs and heart with intense heat. The target is Stunned for 2d10 Rounds and suffers 1d10 permanent Toughness Damage.",
					"As the attack washes over the target, his skin turns black and peels off while melted fat seeps from his clothing and armour. The target is Stunned for 2d10 Roudns and the attack halves his Strength, Toughness and Agility until he receives medical treatment. The extensive scarring deals 2d5 permanent Fellowship Damage.",
					"The target is completely encase in fire, melting his sking and popping his eyes like superheated eggs. He falls to the ground a blackened corpse.",
					"As above, except in addition, if the target is carrying ammunition, there is a 50% chance it explodes. Unless they can make a successful Evasion Test, all creatures withing 1d5 metres take 1d10+5 Explosive Damage. If the target carried any grenades or missiles, one Round after the Damage was dealt, they detonate where the target's body lies with the normal effects."
				]
			},
			leg:{
				upper:"Leg",
				effects:[
					"The blast of energy sears the flesh and bone of the target's leg, leaving a nasty burn scar. The target may not Run or Charge for 2 Rounds.",
					"The attack flash-fries the target's leg, cooking chunks of flesh into char. The target must pass a Challenging (+0) Toughness Test or suffer 1 level of Fatigue.",
					"A solid blow to the leg sends currents of agony coursing through the target. The target suffers 1 level of Fatigue and reduces his Movement by half (rounding up) for 1d10 Rounds. The Target is knocked Prone.",
					"The blast causes a nasty compound fracture in the target's leg. The target reduces his Movement by half (rounding up), and the target may not Run or Charge. The effects to the target's Movement persist until the target receives medical attention.",
					"The target's leg endures horrific burn Damage, fusing clothing and armour with flesh and bone. The target suffers 1 level of Fatigue and reduces his movement by half (rounding up) for 2d10 Rounds. The target is knocked Prone.",
					"The attack burns the target's foot, charring flesh and emitting a foul aroma. The target musht make a Challenging (+0) Toughness Test or lose the foot. On a success, the target reduces his movement by 1/2 (rounding up) until he receives medical attention. In addition, the target suffers 2 levels of Fatigue.",
					"The energy attack fries the leg, leaving it a mess of blackened flesh. The leg is broken and until repaired, the target counts as having lost the leg. The target must make a Challenging(+0) Toughness Test or become Stunned for 1 Round. In addition, the target suffers 1d5 levels of Fatigue. The target now only has one leg.",
					"Energy sears through the bone, causing the leg to be severed. The target must take a Challenging (+0) Toughness Test or become Stunned for 1 Round. In addition, the target suffers 1d10 levels of Fatigue and is suffering from Blood Loss. The target now only has one leg.",
					"The force of the attack reduces the leg to little more than a chunk of sizzling gristle. The target makes a Challenging (+0) Toughness Test or die from shock. The leg is utterly lost.",
					"In a terrifying display of power, the leg immolates and fire consumes the target completely. The target dies in a matter of agonising seconds."
				]
			}
		},
		impact:{
			upper:"Impact",
			arm:{
				upper:"Arm",
				effects:[
					"The attack strikes the target's limb, with a powerful blow, causing him to drop anything held in that hand.",
					"The strike leaves a deep bruise, possibly causing minor fractures in the arm. The target suffers 1 level of Fatigue.",
					"The impact smashes into the arm or whatever the target is holding, ripping it away and leaving the target reeling from the pain. The target is stunned for 1 Round and drops whatever he was holding in his arm. There is a 10% chance that anything the target was holding in that hand is Damaged and unusable until repaired.",
					"The impact crushes flesh and bone. The target drops whatever was held in that hand, and must make a Challenging (+0) Toughness Test or suffer 1d10 WS and 1d10 BS Damage.",
					"Muscle and Bone take a pounding as the attack rips into the arm. The limb is useless until the target receives medical attention.",
					"The attack pulverises the target's hand, crushing and breaking 1d5 fingers. The target suffers 1 level of Fatigue and must immediately make a Challenging (+0) Toughness Test or suffer 2 permanent WS and BS Damage.",
					"With a loud snap, the arm is shattered and left hanging limply at the target's side, dribbling blood onto the ground. The arm is broken and until repaired, the target counts as having only one arm. The target suffers from Blood Loss.",
					"The force of the attack takes the arm off just below the shoulder, showering blood and gore across the ground. The target must immediately make a Challenging (+0) Toughness Test or die from shock. If he passes the Test, he is still Stunned for 1d10 Rounds, suffers 1d5 levels of fatigue, and suffers from Blood Loss. He now only has one arm.",
					"In a rain of blood, gore, and meat, the target's arm is removed from his body. Screaming incoherently, he twists about in agony for a few seconds before collapsing to the ground and dying.",
					"As above, except as the arm is removed by the force of the attack, bone, clothing, and armour fragments fly about like shrapnel. Anyone within 2 metres of the target suffers 1d5-3 Impact Damage to a random location (see Table 8-3: Hit Locations on page 250)."
				]
			},
			head:{
				upper:"Head",
				effects:[
					"The impact fills the target's head with a terrible ringing noise. The target must make a Challenging (+0) Toughness Test or suffer 1 level of Fatigue.",
					"The attack causes the target to see stars. The target suffers a -10 penalty to any Perception or Intelligence Tests for 1d5 Rounds.",
					"The target's nose breaks in a torrent of blood, blinding him for 1 Round. The target must make a Challenging (+0) Toughness Test or be Stunned for 1 Round.",
					"The concussive strike staggers the target. The target must make a Challenging (+0) Toughness Test or be Stunned for 1 Round and knocked Prone.",
					"The force of the blow sends the target reeling in pain. The target is Stunned for 1 Round, gains 1 level of Fatigue, and staggers backwards 1d5 metres. He suffers 1 permanent Intelligence Damage.",
					"The target's head is snapped back by the attack leaving him staggering around trying to control mind-numbing pain. The target is Stunned for 1d5 Rounds, knocked backwards 1d5 metres, must make a Challenging (+0) Agility Test or be knocked Prone.",
					"The attack slams into the target's head, fracturing his skull and opening a long tear in his scalp. The target is Stunned for 1d10 Rounds and halves all movement for 1d10 hours.",
					"With a sickening crunch the target's head snaps around to face the opposite direction. The twisted vertebrae immediately sever every connection within the target's neck. Death is instantaneous.",
					"The target's head bursts like an overripe fruit and sprays blood, bone, and brains in all directions. Anyone within 4 metres of the target must make an Agility Test or suffer a -10 penalty to their WS and BS on their next Turn as gore gets in their eyes or on their visors.",
					"As above, except that the attack was so powerful that it passes through the target an dmay hit another target nearby. If the hit was from a melee weapon, the attacker may immediately make another attack (with the same weapon) against any other target they can reach without moving. If the hit was from a ranged weapon they may immediately make another attack (with the same weapon) against any target standing directly behind the original target and still within range of their weapon."
				]
			},
			body:{
				upper:"Body",
				effects:[
					"The blow to the target's body steals the breath from his lungs. The target can only take a Half Action on his next turn.",
					"The impact punches the air from the target's body, inflicting 1 level of Fatigue and knocking the target Prone.",
					"The attack breaks a rib and the target is knocked Prone. The target is also Stunned for 1 Round.",
					"The blow batters the target, shattering a rib. The target suffers 1d10 Toughness Damage and must make a Challenging (+0) Agility Test or be knocked Prone.",
					"A solid blow to the chest pulverises the target's innards, and he momentarily doubles over in pain, clutching himself and crying in agony. The target is Stunned for 2 Rounds and must make a Challenging (+0) Toughness Test or suffer 1d5 levels of Fatigue.",
					"The attack knocks the target sprawling on the ground. The target is flung 1d5 metres away from the attacker and falls Prone (if the target strikes a wall or other solid object, he stops). The target suffers 1d5 levels of Fatigue and is Stunned for 2 Rounds.",
					"With an audibl crack, 1d5 of the target's ribs break. The target can either lie down and stay still awaiting medical attention (a successful Medicae Test sets the ribs ) or continue to take Actions, though each round there is a 20% chance that a jagged rib pierces the a vital organ and kills the character instantly. The target suffers 1d5 permanent Toughness Damage.",
					"The force of the attack ruptures several of the target's organs and knocks him down, gasping in wretched pain. The target suffers Blood Loss and suffers 1d10 permanent Toughness Damage.",
					"The target jerks back from the force of the attck, throwing back his head and spewing out a jet of blood before crumpling to the ground dead.",
					"As above, except the target is thrown 1d10 metres away from the attack. Anyone in the target's pth must make a Challenging (+0) Agility Test or be knocked Prone."
				]
			},
			leg:{
				upper:"Leg",
				effects:[
					"A blow to the leg results in deep bruises and teeth-clenching pain. The target suffers 1 level of Fatigue.",
					"A grazing strike against the leg slows the target. The target's Movement is reduced by half (rounding up) for 1 Round, and he must make a Challenging (+0) Toughness Test or be Stunned for 1 Round and fall Prone.",
					"A solid blow to the leg sends lightning agony coursing through the target. The target suffers 1d10 Agility Damage and is knocked Prone.",
					"A powerful impact causes micro-fractures in the target's bones, inflicting considerable agony. The target suffers 2d10 Agility Damage, and is knocked Prone.",
					"The blow breaks the target's leg, leaving him Stunned for 1 Round and reducing his movement to 1 metre until he receives medical attention. The target is also knocked Prone.",
					"With a sharp cracking noise, several of the tiny bones in the target's foot snap like twigs. The target must make an immediate Challenging (+0) Toughness Test or permanently lose the use of his foot. The target's Movement is reduced by 1/2 (rounding up) until he receives medical Attention. The target suffers 2 levels of Fatigue.",
					"With a nasty crunch, the leg is broken and the target is left mewling in pain. The target falls Prone with a broken leg and, until it is repaired, he counts as only having one leg. The target is Stunned for 2 Rounds.",
					"The force of the attack rips the lower half of the leg away in a stream of blood. The target must immediately make a Challenging (+0) Toughness Test or die from shock. The target suffers from Blood Loss and suffers 1d5 permanent Agility Damage. He now only has one leg.",
					"The hit rips apart the flesh of the leg, causing blood to spray out in all direction. Even as the target tries futilely to stop the sudden flood of vital fluid, he falls to the ground and dies in a spreading pool of gore.",
					"As above, but such is the agony of the target's death that his piteous screams drown out all conversation within 2d10 metres for the rest of the Round."
				]
			}
		},
		rending:{
			upper:"Rending",
			arm:{
				upper:"Arm",
				effects:[
					"The slashing attack tears free anything that was held in this arm.",
					"Deep cuts cause the target to drop whatever was held and inflicts 1 level of Fatigue.",
					"The attack shreds the target's arm into ribbons, causing the target to scream in pain. The target drops whatever was held in that hand and must make a successful Challenging (+0) Toughness Test or suffer Blood Loss.",
					"The attack flays the skin from the limb, filling the air with blood and the sounds of his screaming. The target falls Prone from the agony and takes 2 levels of Fatigue. The limb is useless for 1d10 Rounds.",
					"A bloody and very painful looking furrow is opened up in the target's arm. The target suffers from Blood Loss and vomits all over the place in agony. He drops anything nheld and the limb is useless without medical attention.",
					"The blow mangles flesh and muscle as it hacks into the target's hand, liberating 1d5 fingers in the process (a roll of 5 means that the thumb has been sheared off too). The target is Stunned for 1 Round and must immediately make a Challenging (+0) Toughness Test or lose the use of his hand.",
					"The attack rips apart skin, muscle, bone, and sinew with ease, turning the target's arm into a dangling ruin. The target suffers 1d10 Strength Damage. The arm is broken and, until repaired, the target counts as having only one arm. In addition, numberous veins have been severed and the target is now suffering from Blood Loss.",
					"With an assortment of unnatural, wet, ripping sounds, the arm flies free of the body trailing blood behind it win a crimson arc. The target must immediately make a Challenging (+0) Toughness Test or die from shock. If he passes the Test, he is Stunned for 1d10 Rounds and suffers from Blood Loss. He now only has one arm.",
					"The attack slices clean through the arm and into the torso, drenching the ground in blood and gore and killing the target instantly.",
					"As avove. However, as the arm falls to the ground its fingers spasm uncontrollably, pulling the trigger of any held weapon. If the targe was carrying a ranged weapon there is a 5% chance that a single randomly determined target withing 2d10 metres is hit by these shots, in which case resolve a single hit from the target's weapon."
				]
			},
			head:{
				upper:"Head",
				effects:[
					"The attack tears a painful rent in the target's face. They suffer 1 level of Fatigue. If the target is wearing a helmet, there is no effect. Lucky!",
					"The attack slices open the target's scalp, which immediately begins to bleed profusely. Due to blood pouring into the target's eyes, he suffers a -10 penalty to both Weapon Skill and Ballistic Skill for the next 1d10 Turns. The target must pass a Challenging (+0) Toughness test or suffer from Blood Loss.",
					"The attack rips open the target's face, leaving him Stunned for 1d5 Rounds. If the target is wearing a helmet, the helmet is torn off. The target suffers Blood Loss.",
					"The attacke slices across one of the target's eye sockets, possibly scooping out the eye. He must make a Routine (+20) Toughness Test or lose the eye (augmetics can repair this). He also suffers 1d10 Perception Damage.",
					"The attack tears the target's helmet from his head. If wearing no helmet, the target loses an ear instead, becoming Deafened until he receives medical attention. If he loses an ear, he must also pass a Challenging (+0) Toughness Test of suffer 1 point of permanent Fellowship Damage. The target is Stunned for 1d5 Rounds.",
					"As the blow rips violently across the target's face it takes with it an important feature. Roll 1D10 to see what the target has lost. 1-2: Eye (see Conditions and Special Damage on page 266), 4-7: Nose (the target suffers 1d10 permanent Fellowship Dmage), 8-10: Ear (the target is Deafened until he recieves medical attention). In addition, the target is now suffering from Blood Loss and suffers 1d5 levels of Fatigue.",
					"In a splatter of skin and teeth, the attack removes most of the target's face. He is permanently blinded and has his Fellowship permanenty reduced to 1d10, and no also has trouble speaking without slurring his words. In addition, the target is suffering from Blood Loss and is Stunned for 1 Round.",
					"The blow slices into the side of the target's head causing his eyes to pop out and his brain to ooze down his cheek like spilled jelly. He's dead before he hits the ground.",
					"With a sound not unlike a wet sponge being torn in half, the target's head flies free of its body and sails through the air, landing harmlessly 1d10 metres away with a soggy thid. The target is instantly slain.",
					"As above, except the target's neck spews blood in a torrent, drenching all those nearyby and forcing them to make a Challenging (+0) Agility Test. Anyone who fails the Test suffers a -10 penalty to Weapon Skill and Ballistic Skill tests for 1 Round as gore fills his eyes or fouls his visor."
				]
			},
			body:{
				upper:"Body",
				effects:[
					"If the target is not wearing armour in this location, he takes 1 level of Fatigue from a painful laceration. If he is wearing armour, there is no effect. Phew!",
					"A powerful slash opens a painful rent in the target's body. He suffers 1 level of Fatigue and must make a Challenging (+0) Toughness or become Stunned for 1 Round.",
					"The attack rips a large patch of skin from the target's torso, leaving him gasping in pain. The target is Stunned for 1 Round and must make a Challenging (+0) Toughness Test or suffer from Blood Loss.",
					"The blow opens up a long wound in the target's torso, causing him to double over in terrible pain. The target suffers from Blood Loss and is stunned for 1 Round.",
					"A torrent of blood spilsl from deep cuts, making the gorund slick with gore. All characters attempting to move through this pool of blood must make a Challenging (+0) Agility Test or fall Prone. The target suffers 1d10 Toughness Damage and also suffers Blood Loss.",
					"The mighty attack takes a sizeable chunk out of the target and knocks him to the ground as he clutches the oozing wound, shrieking in pain. The targe is knocked Prone and suffers 1d10 Toughness Damage and Blood Loss.",
					"The attack cuts open the target's abdomen. The target can either choose to use one arm to hold his guts in (until a medic can bind them in place with a successful Medicae Test), or fight on regardless and risk a 20% chance each Round that his middle splits open, spilling his intestines all over the ground, causing an additional 2d10 Damage. In either case, the target suffers 1d5 permanent Toughness Damage and is now suffering Blood Loss.",
					"With a vile tearing noise, the skin on the target's chest comes away revealing a red ruin of muscle. The target must make a Challenging (+0) Toughness Test or die. If he passes, he suffers 1d10 permenent Tougness Damage, is stunned for 1 Round, and now suffers Blood Loss.",
					"The powerful blow cleaves the target from gullet to groin, revealing his internal organs and spilling them on to the ground before him. The target is now quite dead.",
					"As above, except that the area and the target are awash with gore. For the rest of the fight, anyone moving withing four metres of teh target's corpse must make a Challenging (+0) Agility Test or fall Prone."
				]
			},
			leg:{
				upper:"Leg",
				effects:[
					"The attack knocks the limb backwards, painfully twisting it awkwardly. The target suffers 1 level of Fatigue.",
					"The target's kneecap splits open. He must make a Challenging (+0) Agility Test or fall Prone and suffer from Blood Loss as the already Damaged extremity hits the ground.",
					"The attack rips a length of flesh from the leg. The target suffers 1d5 Agility Damage and suffers Blood Loss.",
					"The attack rips the kneecap from the target's leg, causing it to collapse out from under him. The target's Movement is reduced by 1/2 (rounding up) until medical attention is received. In addition, he is knocked Prone and suffers 1d10 Agility Damage.",
					"In a spray of blood, the target's leg is deeply slahed, exposing bone, sinew, and muscle. The target suffers Blood Loss, and must make a Challenging (+0) Toughness Test or suffer 1 point of permanent Agility Damage.",
					"The blow slices a couple of centimetres off the end of the target's foot. The target must make an immediate Challenging (+0) Toughness Test or permanently lose the use of his foot. On a success the target's Movement is reduced by half (rounding up). In either case, the target suffers Blood Loss.",
					"The force of the blow cuts deep into the leg, grinding against bone and tearing ligaments apart. The leg is broken and, until repaired, the target counts as having only one leg. In addition, the level of maiming is such that the target is now suffering from Blood Loss. He is also Stunned for 1 Round and is knocked Prone.",
					"In a single bloody hack, the target's leg is lopped off, spurting vital fluids across the ground. The target must immediately make a Challenging (+0) Toughness Test or die from shock. On a success, the target is Stunned for 1d10 Rounds, and suffers from Blood Loss. He now only has one leg.",
					"With a meaty chop, the leg comes away at the hip. The target pitches to the ground howling in agony before dying.",
					"As above, except the that the tide of blood is so intense that, for the remainder of the battle, anyone making a Run or Charge Action within six metres of the target must make a Challenging (+0) Agility Test or be knocked Prone."
				]
			}
		},
		explosive:{
			upper:"Explosive",
			arm:{
				upper:"Arm",
				effects:[
					"The attack throws the limb backwards, painfully jerking it away from the body, inflicting 1 level of Fatigue.",
					"The force of the blast snaps the bones fo the arm in half. The target drops anything held in the hand and must pass a Challenging (+0) Toughness Test or become Stunned for 1 Round.",
					"The explosion removes 1 finger (and the tips from up to 1d5 others) from the target's hand. The target suffers 1d10 WS and 1d10 BS Damage, and anything carried in the hand is destroyed. If this is an explosive such as a hand grenade, it goes off - messy (use result 9 instead).",
					"The blast rips the sinew of the arm straight from the bone. He is Stunned for 1 Round, and the limb is useless until medical attention is received. The target must make a Challenging (+0) Toughness Test or suffer Blood Loss.",
					"Fragments from the explosion tear into the target's hand, ripping away flesh and muscle alike. He must immediately make an Ordinary (+10) Toughness test of lose his hand. If he scucceedss, he suffers 1 permanent Weapon Skill and Ballistic Skill Damage from the Damaged nerves.",
					"The explosvie attack shatters the bone and mangles the flesh, turning the target's arm into a red ruin, inflicting 1d5 levels of Fatigue. The target's arm is broken and, until repaired, the target counts as having only one arm. In addition, the horrendous nature of the wound means that he now suffers from Blood Loss.",
					"In a violent hail of flesh, the arm is blown apart. The target must immediately make a Challenging (+0) Toughness Test or die from shock. On a success, the target is Stunned for 1d10 Rounds, suffers 1d10 levels of Fatigue, and suffers Blood Loss. he now only has one arm.",
					"The arm disintegrates under the force of the explosion taking a good portion of the shoulder and chest with it. The target is sent screaming to the ground, where he dies in a pool of his own blood and organs.",
					"With a mighty bang the arm is blasted from the target's body, killing the target instantly in a rain of blood droplets. In addition, fi the target was carrying a weapon with a power source in his hand (such as a power sword or chainsword) then it explodes, dealing 1d10+5 Impact Damage to anyone within two metres.",
					"As above, except if the target is carrying ammunition it explodes dealing 1d10+5 Impact Damage to anyone within 1d10 metres (this is in addition to Damage caused by exploding power weapons noted above). If the target is carrying any grenades or missiles, these detonate imediately."
				]
			},
			head:{
				upper:"Head",
				effects:[
					"The explosion leaves the target confused. He can only take a Half Action on his next Turn.",
					"The flas and noise leaves the target Blinded and Deafened for 1 Round.",
					"The detonation leaves the target's face a bloody ruin from scores of small cuts. Permanent scarring is very likely. The target suffers 2 levels of Fatigue and must make a Challenging (+0) Toughness Test or suffer 1 permanent Intelligence Damage and be Stunned for 2 Rounds.",
					"The force of the blast knocks the target to the ground and leaves him senseless. The target suffers 1d10 Intelligence Damage and is knocked Prone. He must also pass a Challenging (+0) Toughness Test or suffer 1 permanent Intelligence Damage and be Stunned for 2 Rounds.",
					"The explosion flays the flesh from the target's face an dbursts his eardrums with its force. The target is Stunned for 1d10 Rounds and is permanently deafened. Finally, the target gains hideous scars - he suffers 1d5 pointsof permanent Fellowship Damage.",
					"The target's head explodes under the force of the attack, leaving his headless corpse to spurt blood from the neck for the next few minutes. Needless to say this is instantly fatal.",
					"Both head and body are blown into a mangled mess, instantly killing the target. In addition, if the target is carrying ammunition it explodes dealing 1d10+5 Impact Damage to any creatures withing 1d5 metres. If the target was carrying grenades or missiles, these too explode immediately.",
					"In a series of unpleasant explosions the target's head and torso peel apart, leaving a gory mess on the ground. For the rest of the fight, anyone moving over this spot must make a Challenging (+0) Agility Test or fall Prone.",
					"The target ceases to exist in any tangible way, entirely turning into a kind of crimson mist. You don't get much deader than this, except....",
					"As above, except such is the unspeakably appalling mannerin which the target was killed, that any of the target's allies who are within two metres of where the target stood, must make an immediate Challenging (+0) Willpower Test or spend their next Turn fleeing from the attacker."
				]
			},
			body:{
				upper:"Body",
				effects:[
					"The explosion flings the target backwards 1d5 metres.The target is knocked Prone.",
					"The target is blown backwards 1d5 metres by a terrific explosion, taking 1 level of Fatigue per metre travelled. The target is knocked Prone.",
					"The force of the blast sends the target sprawling to the ground. The target is knocked backwards 1d5 metres, Stunned for 1 Round, and is knocked Prone.",
					"The power of the explosion rends flesh and bone with horrific results. The target must make a Challenging (+0) Toughness Test or suffer from Blood Loss and be Stunned for 1 Round.",
					"Concussion from the explosion knocks the target to the ground and turns his innards into so much ground meat. The target must immediately make a Challenging (+0) Toughness Test or suffer Blood Loss and 1 permanent Toughness Damage. The target then suffers 1d5 levels of Fatigue and is knocked prone.",
					"Chunsk of he target's flesh are ripped free by the force of the attack leaving large, weeping wounds. The target is Stuned for 1 Round, may only take a Half Action in his next Round, and is now suffering Blood Loss.",
					"The explosive force of the attack ruptures the target's flesh and scrambles his nervous system, knocking him to the ground. The target suffers Blood Loss, is knocked Prone, is Stunned for 1d10 Rounds, and must make a Challenging (+0) Toughness Test or fall unconscious.",
					"The target's chest explodes outwards, disgorging a river of partially cooked organs onto the ground, killing him instantly",
					"Pieces of the target's body fly in all directions as he is torn into bloody gobbets by the attack. In addition, if the target is carrying ammunition, it explodes dealing 1d10+5 Impact Damage to anyone within 1d10 metres. If the target is carrying any grenades or missiles, these too detonate immediately.",
					"As above, except anyone within 1d10 metres of the target is drenched in gore and must make a Challenging (+0) Agility Test or suffer a -10 penaly to Weapon Skill and Ballistic Skill Tests for 1 Round as blood fouls their sight."
				]
			},
			leg:{
				upper:"Leg",
				effects:[
					"A glancing blast sends the charater backwards one metre. The target must make a Challenging (+0) Toughness Test or be knocked Prone.",
					"The force of teh explosion takes the target's feet out from under him. He is knocked Prone and may only take Half Move Actiond for 1d5 Rounds.",
					"The concussion causes the target's leg to fracture, inflicting 2d10 Agility Damage.",
					"The explosion sends the target spinning through the air. The target is flung 1d5 metres away from the explosion. It takes the target a Full Action to regain his feet, and his Movement is reduced by half (rounding up) for 1d10 Rounds.",
					"Explosive force removes the target's foot and scatters the ragged remnants over a wide area. The target suffers 1d5 permanent Agility Damage. The target must makea  Difficult (-10) Toughness Test or suffer 1d5 levels of Fatigue.",
					"The concussive force of the blast shatters the target's leg bones and splits apart his flesh, inflicting 1d10 levels of Fatigue. The leg is broken and, until repaire, the target counts as having only one leg. The target must also make an immediate Challenging (+0) Toughness Test or permanently lose his foot.",
					"The explosion reduces the target's leg into a hunk of smoking meat. The target must immediately make a Challenging (+0) Toughness Test or die from sock. On a successful Test, the target is still Stunned for 1d10 Rounds, suffers 1d10 levels of Fatigue, and suffers Blood Loss. He now has only one leg.",
					"The blast tears the leg from the body in a geyser of gore, sending him crashing to the ground, blood pumping from the ragged stump; instantly fatal.",
					"hThe leg explodes in an eruption of blood, killing the target immediately and sending tiny fragments of bone, clothing, and armour hurtling off in all directions. Anyone within two metres suffers 1d10+2 Impact Damage.",
					"As above, except in addition, if the target is carrying any ammunition, it exploces dealing 1d10+5 Impact Dmage to anyone withing 1d10 metres. If the target is carrying any grenades or missiles, these detonate immediately."
				]
			}
		}
	}

	var popupText = finalDamageDescription;

	popupText += "<hr><ol>";
	for (critIdx = 0;critIdx < critTables[damageType][location].effects.length;++critIdx)
	{
		popupText += "<li>";
		popupText += critTables[damageType][location].effects[critIdx] + "<br>"
		popupText += "</li>";
	}
	popupText += "</ol>";

	var popupHeader = critTables[damageType].upper + " Critical Hit Table For " + critTables[damageType][location].upper;
	showPopup(popupHeader, popupText);
}

function weaponRangeChange()
{
	var rangeValue = getEffectiveRange();

	var shortRangeDisplay = document.getElementById("shortRange");
	var longRangeDisplay = document.getElementById("longRange");
	var extremeRangeDisplay = document.getElementById("extremeRange");

	shortRangeDisplay.innerHTML = "Short Range (+10): " + (rangeValue*0.5);
	longRangeDisplay.innerHTML = modifierDescriptions.targetRangeModifier.longRange.description + ": " + (rangeValue*2);
	extremeRangeDisplay.innerHTML = modifierDescriptions.targetRangeModifier.extremeRange.description + ": " + (rangeValue*3);

	var rangeModifierContainer = document.getElementById("targetRangeModifier");
	rangeModifierContainer.children.slider.max = (rangeValue * 4)+2;

	recalculate();
}

function getEffectiveRange()
{
	var weaponRange = parseInt(document.getElementById("weaponRange").value);

	if (document.getElementById("weaponMaximal").children.check.checked)
	{
		weaponRange += 10;
	}
	return weaponRange;
}

function targetRangeChanged()
{
	var rangeModifierContainer = document.getElementById("targetRangeModifier");

	var rangeValue = parseInt(rangeModifierContainer.children.slider.value);
	var weaponRange = getEffectiveRange();

	var rangeDescription = "" + rangeValue + "m"
	if (rangeValue <= 2)
	{
		rangeDescription += " Point Blank (+30)";
	}
	else if (rangeValue < (weaponRange*0.5))
	{
		rangeDescription += " Short Range (+10)";
	}
	else if (rangeValue <= (weaponRange*2))
	{
		rangeDescription += " Standard Range (+0)";
	}
	else if (rangeValue <= (weaponRange*3))
	{
		rangeDescription += " " + modifierDescriptions.targetRangeModifier.longRange.description;
	}
	else if (rangeValue <= (weaponRange*4))
	{
		rangeDescription += " " + modifierDescriptions.targetRangeModifier.extremeRange.description;
	}
	else
	{
		rangeDescription += " Out of Range";
	}

	rangeModifierContainer.children.valueDescription.innerHTML = rangeDescription;

	recalculate();
}

function addModifiersForRange()
{
	var rangeModifier = 0;
	var rangeModifierContainer = document.getElementById("targetRangeModifier");

	var rangeValue = parseInt(rangeModifierContainer.children.slider.value);
	var weaponRange = getEffectiveRange();

	var hasScope = document.getElementById("weaponTelescopicSight").children.check.checked;
	var isAiming = !document.getElementById("aimModifier").children.none.checked;
	var isMarksman = document.getElementById("marksmanTalent").children.check.checked;
	var ignoreExtremeAndLong = isMarksman || (hasScope && isAiming);

	var rangeDescription = "" + rangeValue + "m"
	if (rangeValue <= 2)
	{
		finalDescription += "Point Blank (+30)<br>";
		rangeModifier = 30;
	}
	else if (rangeValue < (weaponRange*0.5))
	{
		finalDescription += " Short Range (+10)<br>";
		rangeModifier = 10;
	}
	else if (rangeValue <= (weaponRange*2))
	{
	}
	else if (rangeValue <= (weaponRange*3))
	{
		if (!ignoreExtremeAndLong)
		{
			finalDescription += " Long Range (-20)<br>";
			rangeModifier = -20;
		}
	}
	else if (rangeValue <= (weaponRange*4))
	{
		if (!ignoreExtremeAndLong)
		{
			finalDescription += " Extreme Range (-30)<br>";
			rangeModifier = -30;
		}
	}
	else
	{
		finalDescription += " Out of Range";
		rangeModifier = -1000;
	}

	return rangeModifier;
}

function showPopup(headerText, bodyText)
{
	document.getElementById("popup").style.visibility = 'visible';
	document.getElementById("popupHeader").innerHTML = headerText;
	document.getElementById("popupBody").innerHTML = bodyText;
}

function hidePopup()
{
	document.getElementById("popup").style.visibility = 'hidden';
}

function talentChanged()
{
	var deadeye = document.getElementById("deadeyeTalent").children.check.checked;
	var sharpshooter = document.getElementById("sharpshooterTalent").children.check.checked;
	if (deadeye && sharpshooter)
	{
		modifierDescriptions.calledShotModifier.value = 0;
		modifierDescriptions.calledShotModifier.description = "Called Shot (+0)"
		document.getElementById("calledShotModifier").children.valueDescription.innerHTML = "Called Shot (+0)"
	}
	else if (deadeye || sharpshooter)
	{
		modifierDescriptions.calledShotModifier.value = -10;
		modifierDescriptions.calledShotModifier.description = "Called Shot (-10)"
		document.getElementById("calledShotModifier").children.valueDescription.innerHTML = "Called Shot (-10)"
	}
	else
	{
		modifierDescriptions.calledShotModifier.value = -20;
		modifierDescriptions.calledShotModifier.description = "Called Shot (-20)"
		document.getElementById("calledShotModifier").children.valueDescription.innerHTML = "Called Shot (-20)"
	}

	if (document.getElementById("armsMasterTalent").children.check.checked)
	{
		modifierDescriptions.weaponUntrainedModifier.value = -10;
		modifierDescriptions.weaponUntrainedModifier.description = "Weapon Untrained (-10)"
		document.getElementById("weaponUntrainedModifier").children.valueDescription.innerHTML = "Weapon is untrained (-10)"
	}
	else
	{
		modifierDescriptions.weaponUntrainedModifier.value = -20;
		modifierDescriptions.weaponUntrainedModifier.description = "Weapon Untrained (-20)"
		document.getElementById("weaponUntrainedModifier").children.valueDescription.innerHTML = "Weapon is untrained (-20)"
	}

	if (document.getElementById("targetSelectionTalent").children.check.checked)
	{
		modifierDescriptions.shootingIntoMeleeModifier.value = 0;
		modifierDescriptions.shootingIntoMeleeModifier.description = "Shot Into Melee (+0)"
		document.getElementById("shootingIntoMeleeModifier").children.valueDescription.innerHTML = "Shooting Into Melee (+0)"
	}
	else
	{
		modifierDescriptions.shootingIntoMeleeModifier.value = -20;
		modifierDescriptions.shootingIntoMeleeModifier.description = "Shot Into Melee (-20)"
		document.getElementById("shootingIntoMeleeModifier").children.valueDescription.innerHTML = "Shooting Into Melee (-20)"
	}	

	if (document.getElementById("bulgingBicepsTalent").children.check.checked)
	{
		modifierDescriptions.weaponHeavyBracedModifier.value = 0;
		document.getElementById("weaponHeavyBracedModifier").children.valueDescription.innerHTML = "Heavy weapon and not braced (+0)"
	}
	else
	{
		modifierDescriptions.weaponHeavyBracedModifier.value = -30;
		document.getElementById("weaponHeavyBracedModifier").children.valueDescription.innerHTML = "Heavy weapon and not braced (-30)"
	}

/*
	aimModifier:{
		half: {value:10,description:"Half Aim (+10)"},
		full: {value:20,description:"Full Aim (+20)"}
	},
*/
	if (document.getElementById("weaponAccurate").children.check.checked)
	{
		modifierDescriptions.aimModifier.half.value = 20;
		modifierDescriptions.aimModifier.half.description = "Half Aim (+20)"
		document.getElementById("aimHalfLabel").innerHTML = "Half Action (+20)"

		modifierDescriptions.aimModifier.full.value = 30;
		modifierDescriptions.aimModifier.full.description = "Full Aim (+30)"
		document.getElementById("aimFullLabel").innerHTML = "Full Action (+30)"
	}
	else
	{
		modifierDescriptions.aimModifier.half.value = 10;
		modifierDescriptions.aimModifier.half.description = "Half Aim (+10)"
		document.getElementById("aimHalfLabel").innerHTML = "Half Action (+10)"

		modifierDescriptions.aimModifier.full.value = 20;
		modifierDescriptions.aimModifier.full.description = "Full Aim (+20)"
		document.getElementById("aimFullLabel").innerHTML = "Full Action (+20)"
	}

	//marksman or scope && isAiming
	var isAiming = !document.getElementById("aimModifier").children.none.checked;
	var hasScope = document.getElementById("weaponTelescopicSight").children.check.checked;
	var isMarksman = document.getElementById("marksmanTalent").children.check.checked;
	if (isMarksman || (isAiming && hasScope))
	{
		modifierDescriptions.targetRangeModifier.longRange.value = 0;
		modifierDescriptions.targetRangeModifier.longRange.description = "Long Range (+0)";
		document.getElementById("longRange").innerHTML = "Long Range (+0)";

		modifierDescriptions.targetRangeModifier.extremeRange.value = 0;
		modifierDescriptions.targetRangeModifier.extremeRange.description = "Extreme Range (+0)";
		document.getElementById("extremeRange").innerHTML = "Extreme Range (+0)";
	}
	else
	{
		modifierDescriptions.targetRangeModifier.longRange.value = -20;
		modifierDescriptions.targetRangeModifier.longRange.description = "Long Range (-20)"
		document.getElementById("longRange").innerHTML = "Long Range (-20)";
		
		modifierDescriptions.targetRangeModifier.extremeRange.value = -30;
		modifierDescriptions.targetRangeModifier.extremeRange.description = "Extreme Range (-30)"
		document.getElementById("extremeRange").innerHTML = "Extreme Range (-30)";
	}

	targetRangeChanged();
	weaponRangeChange();
}

function setRangeStandard()
{
	var rangeValue = getEffectiveRange();
	var rangeModifierContainer = document.getElementById("targetRangeModifier");
	rangeModifierContainer.children.slider.value = rangeValue;

	targetRangeChanged();
}
function setRangePointBlank()
{
	var rangeModifierContainer = document.getElementById("targetRangeModifier");
	rangeModifierContainer.children.slider.value = 2;

	targetRangeChanged();
}
function setRangeLong()
{
	var rangeValue = getEffectiveRange();
	var rangeModifierContainer = document.getElementById("targetRangeModifier");
	rangeModifierContainer.children.slider.value = (rangeValue*2)+2;

	targetRangeChanged();
}
function setRangeShort()
{
	var rangeValue = getEffectiveRange();
	var rangeModifierContainer = document.getElementById("targetRangeModifier");
	rangeModifierContainer.children.slider.value = (rangeValue*0.5)-2;

	targetRangeChanged();
}
function setRangeExtreme()
{
	var rangeValue = getEffectiveRange();
	var rangeModifierContainer = document.getElementById("targetRangeModifier");
	rangeModifierContainer.children.slider.value = (rangeValue*3)+2;

	targetRangeChanged();
}
</script>
</head>
<body onload="initialize()">
<div id="header">
	Only War Shot Calculator
</div>
<div id="content" class="rounded">
<div id="popup">
	<div id="popupContents">
		<div id="popupHeader" class="boxheader">
			Header
		</div>
		<div id="popupClose" class="hoverable" onclick="hidePopup()">close</div>
		<div id="popupBody">
			Popup text boes here. Don't mess it up
		</div>
	</div>
</div>

<div id="calculator" class="rounded">
	<p class="sectionheader">
		Enter your ballistic skill on the left and set the dice roll to what shows up on your dice
	</p>
	<div id="BallisticSkillContainer" class="cornered">
		<p class="boxheader">Ballistic Skill</p>
		<input type="number" id="BallisticSkill" rows="1" value="30" oninput="recalculate()"></input>
	</div>
	<p class="BigLetter">+</p>
	<div id="FinalModifierDescription" class="cornered">
		Modifiers will go here
	</div>
	<p class="BigLetter">=</p>
	<p id="FinalBallisticSkill">30</p>
	<div id="DiceRoll" class="cornered">
		<p class="boxheader">Dice Roll</p>
		<p id="diceValue">10</p>
		<input type="range" min="1" max="100" class="diceSlider" id="slider" value=10 oninput="diceRollChanged()"></input>
	</div>
	<div id="FinalResultDescription" class="cornered">
		<p class="boxheader">Result</p>
		<p id="resultDescription">Attack Results with hit locations and links to crit tables</p>
		<p id="degreesOfSuccess" class="boxfooter">0 Degrees of Success</p>
	</div>
</div>

<div id="sidead">
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- Banner728x90 -->
	<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-7668088080506907"
     data-ad-slot="8204011076"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
</div>

<div class="column">
	<div id="weapon" class="rounded">
		<p class="sectionheader">
			Weapon Stats
		</p>
		<div class="modifier" id="weaponRangeInput">
			<div class="fullwidth">
				<textarea id="weaponName" class="fullwidth" oninput="saveOptions()" placeholder="Weapon Name"></textarea>
				<input type="number" id="damageDice" oninput="recalculate()" value=1 /> d10+
				<input type="number" id="damageAdd" oninput="recalculate()" value=3 />
				<select id="weaponDamageType" onchange="recalculate()">
					<option value="energy">Energy Damage</option>
					<option value="impact">Impact Damage</option>
					<option value="rending">Rending Damage</option>
					<option value="explosive">Explosive Damage</option>
				</select>
			 	Pen<input type="number"  id="damagePen" value=3 />
			 	RoF
				<input type="number" id="singleShotAmount" min=0 oninput="recalculate()" value=1 />/
				<input type="number" id="semiAutoAmount" min=0 oninput="recalculate()" value=2 />/
				<input type="number" id="fullAutoAmount" min=0 oninput="recalculate()" value=6 />
			</div>
			<span class="fullwidth">
				<input type="number" id="weaponRange" value=100 oninput="weaponRangeChange()">Weapon Range</input>
				<sup class="hoverable"onclick="setRangeStandard()" title="Click to set range slider to standard"> &#8594;</sup>
			</span>
			<span class="halfwidth">
				<span>Point Blank (+30): 2m</span>
				<sup class="hoverable"onclick="setRangePointBlank()" title="Click to set range slider to point blank"> &#8594;</sup>
			</span>

			<span class="halfwidth">
				<span id="longRange">Long Range (-20): 2m</span>
				<sup class="hoverable"onclick="setRangeLong()" title="Click to set range slider to long range"> &#8594;</sup>
			</span>

			<span class="halfwidth">
				<span id="shortRange">Short Range (+10): 2m</span>
				<sup class="hoverable"onclick="setRangeShort()" title="Click to set range slider to short range"> &#8594;</sup>
			</span>

			<span class="halfwidth">
				<span id="extremeRange">Extreme Range (-30): 2m</span>
				<sup class="hoverable"onclick="setRangeExtreme()" title="Click to set range slider to extreme range"> &#8594;</sup>
			</span>
		</div>
		<div class="checkboxmodifier" id="weaponCustomGripModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
			Weapon has custom grip (+5)
			</p>
		</div>
		<div class="checkboxmodifier" id="weaponScatter">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
			Scatter weapon
			</p>
		</div>
		<div class="checkboxmodifier" id="weaponOverheats">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
			Overheats
			</p>
		</div>
		<div class="checkboxmodifier" id="weaponMaximal">
			<input type="checkbox" id="check" onchange="weaponRangeChange()"> </input>
			<p id="valueDescription">
			Fire on Maximal (3x ammo cost. Recharge next round)
			</p>
		</div>
		<div class="modifier" id="weaponAccurate">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Weapon is accurate (+10 and bonus damage when aiming)
			</p>
		</div>
		<div class="checkboxmodifier" id="weaponUntrainedModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Weapon is untrained (-20)
			</p>
		</div>
		<div class="modifier" id="weaponLaserSight">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Laser Sight (+10 in Single Shot Mode)
			</p>
		</div>
		<div class="modifier" id="weaponTelescopicSight">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Telescopic Sight (Aim for no penalties at long and extreme range)
			</p>
		</div>
		<div class="checkboxmodifier" id="weaponHeavyBracedModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Heavy weapon and not braced (-30)
			</p>
		</div>
	</div>

	<div id="talents" class="rounded">
		<p class="sectionheader">
			Player Talents
		</p>
		<div class="checkboxmodifier" id="deadeyeTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Deadeye Shot (reduce called shot penalty by 10)
			</p>
		</div>
		<div class="checkboxmodifier" id="sharpshooterTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Sharpshooter (reduce called shot penalty by 10)
			</p>
		</div>
		<div class="checkboxmodifier" id="armsMasterTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Arms Master (reduces untrained weapon penalty by 10)
			</p>
		</div>
		<div class="checkboxmodifier" id="marksmanTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Marksman (No Penalties for long and extreme range)
			</p>
		</div>
		<div class="checkboxmodifier" id="targetSelectionTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Target Selection (No Penalty for firing into melee)
			</p>
		</div>
		<div class="checkboxmodifier" id="bulgingBicepsTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Bulging Biceps (No penalty for unbraced heavy weapon)
			</p>
		</div>
		<div class="checkboxmodifier" id="mightyShotTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Mighty Shot (Add half BS bonus to damage)
			</p>
		</div>
		<div class="checkboxmodifier" id="ambushTalent">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Ambush (+1 damage/2 degrees of success on unaware target)
			</p>
		</div>
		<div class="modifier" id="lasWeaponExpertiseTalent">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Las Weapon Expertise (target dodge penalty for degrees of success)
			</p>
		</div>
		<div class="checkboxmodifier" id="lasWeaponMasteryTalent">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Las Weapon Mastery (bonus damage based on degrees of success)
			</p>
		</div>
		<div class="checkboxmodifier" id="lasgunVolleyTalent">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Lasgun Volley (extra damage when using Ranged Volley Order)
			</p>
		</div>
		<div class="checkboxmodifier" id="lasgunBarrageTalent">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Lasgun Barrage (extra DoS on full/semi-auto when not moving)
			</p>
		</div>
		<div class="checkboxmodifier" id="eyeOfVengeanceTalent">
			<input type="checkbox" id="check" onchange="talentChanged()"> </input>
			<p id="valueDescription">
				Eye Of Vengeance (fate point adds to damage and pen)
			</p>
		</div>
	</div>
	<div id="comrade" class="rounded">
		<p class="sectionheader">
			Comrades
		</p>
		<div class="radiomodifier" id="comradeOrderModifier">
			<input type="radio" name="comrade" id="none" onClick="recalculate()" checked></input>
			<label for="none">No Order</label>

			<input type="radio" name="comrade" id="normal" onClick="recalculate()"></input>
			<label for="normal">Ranged Volley (+5)</label>

			<input type="radio" name="comrade" id="veteran" onClick="recalculate()"></input>
			<label for="veteran">Veteran Order (+10)</label>
		</div>
	</div>
</div>

<div class="column">
	<div id="shotmodifiers" class="rounded">
		<p class="sectionheader">
			Standard shot modifiers
		</p>

		<div class="radiomodifier" id="attackType">
			<input type="radio" name="attack" id="single" onClick="recalculate()" checked></input>
			<label for="single">Single Shot (+10)</label>

			<input type="radio" name="attack" id="semi" onClick="recalculate()"></input>
			<label for="semi">Semi-Auto (+0)</label>

			<input type="radio" name="attack" id="full" onClick="recalculate()"></input>
			<label for="full">Fully-Auto (-10)</label>
		</div>

		<div class="radiomodifier" id="aimModifier">
			<input type="radio" name="aim" id="none" onClick="talentChanged()" checked></input>
			<label for="none">No Aim (+0)</label>

			<input type="radio" name="aim" id="half" onClick="talentChanged()"></input>
			<label for="half" id="aimHalfLabel">Half Action (+10)</label>

			<input type="radio" name="aim" id="full" onClick="talentChanged()"></input>
			<label for="full"id="aimFullLabel">Full Action (+20)</label>
		</div>

		<div class="checkboxmodifier" id="calledShotModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Called Shot (-20)
			</p>
			<br>
			<span class="halfwidth" id="headShotContainer">
				<input type="radio" name="calledShotChoice" id="head" onClick="recalculate()" checked></input>
				<label for="head">Head</label>
			</span>

			<span class="halfwidth" id="bodyShotContainer">
				<input type="radio" name="calledShotChoice" id="body" onClick="recalculate()"></input>
				<label for="body">Body</label>
			</span>

			<span class="halfwidth" id="armShotContainer">
				<input type="radio" name="calledShotChoice" id="arm" onClick="recalculate()"></input>
				<label for="arm">Arm</label>
			</span>

			<span class="halfwidth" id="legShotContainer">
				<input type="radio" name="calledShotChoice" id="leg" onClick="recalculate()"></input>
				<label for="leg">Leg</label>
			</span>
		</div>
		<div class="checkboxmodifier" id="guardedActionModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Guarded Action (-10 WS/BS) (+10 Evasion Tests)
			</p>
		</div>
		<div class="checkboxmodifier" id="suppressingFireModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Suppressing Fire (-20)
			</p>
		</div>
		<div class="checkboxmodifier" id="darknessModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Dark (-30)
			</p>
		</div>
		<div class="checkboxmodifier" id="fogModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Fog/Mist/Shadow/Smoke/Harsh Weather (-20)
			</p>
		</div>
		<div class="modifier" id="fogModifier">
			<input type="number" id="fatigueLevel" oninput="recalculate()" value=0 />
			<p id="valueDescription">
				Fatigue (Half Ballistic Skill if Fatigue is greater than BS bonus)
			</p>
		</div>

		<div class="slidermodifier" id="miscellaneousModifier">
			<span>Miscellaneous Modifer:</span>
			<input type="range" min="-50" max="50" id="slider" value=0 step=5 oninput="sliderChanged('miscellaneousModifier')" checked></input>
			<p id="valueDescription">
				+0
			</p>
		</div>
	</div>

	<div id="targetmodifiers" class="rounded">
		<p class="sectionheader">
			Combat modifiers related to the target
		</p>
		<div class="modifier" id="targetRangeModifier">
			<span>Range:</span>
			<input type="range" min="0" max="60" class="rangeslider" id="slider" value=50 step=2 oninput="targetRangeChanged()" checked></input>			<p id="valueDescription">
				Extreme (-30)
			</p>
		</div>
		<div class="slidermodifier" id="targetSizeModifier">
			<span>Target Size:</span>
			<input type="range" min="-30" max="60" id="slider" value=0 step=10 oninput="sliderChanged('targetSizeModifier')" checked></input>
			<p id="valueDescription">
				Average (+0)
			</p>
		</div>
		<div class="checkboxmodifier" id="shootingIntoMeleeModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Shooting into Melee (-20)
			</p>
		</div>
		<div class="checkboxmodifier" id="targetStunnedModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Target Stunned (+20)
			</p>
		</div>
		<div class="checkboxmodifier" id="targetUnaware">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Target Unaware (+30)
			</p>
		</div>
		<div class="checkboxmodifier" id="targetProneModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Target Prone (-20)
			</p>
		</div>
		<div class="checkboxmodifier" id="targetRanModifier">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Target Ran (-20)
			</p>
		</div>
		<div class="checkboxmodifier" id="hatredTalent">
			<input type="checkbox" id="check" onchange="recalculate()"> </input>
			<p id="valueDescription">
				Hatred Talent Applies (+10 to attack chosen type of enemy)
			</p>
		</div>
	</div>
	<div id="about" class="rounded">
		<p class="sectionheader">
			About
		</p>
		<div class="modifier" id="rateOfFireLimiter">
			<p id="valueDescription">
				Created to assist with target number and shot result calculation in Only War.
			</p>
		</div>
	</div>
</div>

<div id="footer">
	Rules content is copyright Fantasy Flight Games and used without permission. No endorsement is implied.<br>Questions and comments can be directed to <a href="mailto:durstann@suffernotthewitch.com">durstann@suffernotthewitch.com</a>
</div>
</div>
</body>
</html>